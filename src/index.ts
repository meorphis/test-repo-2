Ly8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0
YWlubGVzcy4KCmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi9jb3JlJzsKaW1w
b3J0ICogYXMgRXJyb3JzIGZyb20gJy4vZXJyb3InOwppbXBvcnQgeyB0eXBl
IEFnZW50IH0gZnJvbSAnLi9fc2hpbXMvaW5kZXgnOwppbXBvcnQgKiBhcyBV
cGxvYWRzIGZyb20gJy4vdXBsb2Fkcyc7CmltcG9ydCAqIGFzIEFQSSBmcm9t
ICdtZW9ycGhpcy10ZXN0LTQvcmVzb3VyY2VzL2luZGV4JzsKCmNvbnN0IGVu
dmlyb25tZW50cyA9IHsKICBwcm9kdWN0aW9uOiAnaHR0cHM6Ly9hcGkuYWNt
ZS5jb20vdjEnLAogIGVudmlyb25tZW50XzE6ICdodHRwczovL3NhbmRib3gu
YWNtZS5jb20vdjEnLAp9Owp0eXBlIEVudmlyb25tZW50ID0ga2V5b2YgdHlw
ZW9mIGVudmlyb25tZW50czsKCmV4cG9ydCBpbnRlcmZhY2UgQ2xpZW50T3B0
aW9ucyB7CiAgLyoqCiAgICogRGVmYXVsdHMgdG8gcHJvY2Vzcy5lbnZbJ01F
T1JQSElTX1RFU1RfNF9BUElfS0VZJ10uCiAgICovCiAgYXBpS2V5Pzogc3Ry
aW5nIHwgdW5kZWZpbmVkOwoKICAvKioKICAgKiBTcGVjaWZpZXMgdGhlIGVu
dmlyb25tZW50IHRvIHVzZSBmb3IgdGhlIEFQSS4KICAgKgogICAqIEVhY2gg
ZW52aXJvbm1lbnQgbWFwcyB0byBhIGRpZmZlcmVudCBiYXNlIFVSTDoKICAg
KiAtIGBwcm9kdWN0aW9uYCBjb3JyZXNwb25kcyB0byBgaHR0cHM6Ly9hcGku
YWNtZS5jb20vdjFgCiAgICogLSBgZW52aXJvbm1lbnRfMWAgY29ycmVzcG9u
ZHMgdG8gYGh0dHBzOi8vc2FuZGJveC5hY21lLmNvbS92MWAKICAgKi8KICBl
bnZpcm9ubWVudD86IEVudmlyb25tZW50OwoKICAvKioKICAgKiBPdmVycmlk
ZSB0aGUgZGVmYXVsdCBiYXNlIFVSTCBmb3IgdGhlIEFQSSwgZS5nLiwgImh0
dHBzOi8vYXBpLmV4YW1wbGUuY29tL3YyLyIKICAgKgogICAqIERlZmF1bHRz
IHRvIHByb2Nlc3MuZW52WydNRU9SUEhJU19URVNUXzRfQkFTRV9VUkwnXS4K
ICAgKi8KICBiYXNlVVJMPzogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDsK
CiAgLyoqCiAgICogVGhlIG1heGltdW0gYW1vdW50IG9mIHRpbWUgKGluIG1p
bGxpc2Vjb25kcykgdGhhdCB0aGUgY2xpZW50IHNob3VsZCB3YWl0IGZvciBh
IHJlc3BvbnNlCiAgICogZnJvbSB0aGUgc2VydmVyIGJlZm9yZSB0aW1pbmcg
b3V0IGEgc2luZ2xlIHJlcXVlc3QuCiAgICoKICAgKiBOb3RlIHRoYXQgcmVx
dWVzdCB0aW1lb3V0cyBhcmUgcmV0cmllZCBieSBkZWZhdWx0LCBzbyBpbiBh
IHdvcnN0LWNhc2Ugc2NlbmFyaW8geW91IG1heSB3YWl0CiAgICogbXVjaCBs
b25nZXIgdGhhbiB0aGlzIHRpbWVvdXQgYmVmb3JlIHRoZSBwcm9taXNlIHN1
Y2NlZWRzIG9yIGZhaWxzLgogICAqLwogIHRpbWVvdXQ/OiBudW1iZXI7Cgog
IC8qKgogICAqIEFuIEhUVFAgYWdlbnQgdXNlZCB0byBtYW5hZ2UgSFRUUChT
KSBjb25uZWN0aW9ucy4KICAgKgogICAqIElmIG5vdCBwcm92aWRlZCwgYW4g
YWdlbnQgd2lsbCBiZSBjb25zdHJ1Y3RlZCBieSBkZWZhdWx0IGluIHRoZSBO
b2RlLmpzIGVudmlyb25tZW50LAogICAqIG90aGVyd2lzZSBubyBhZ2VudCBp
cyB1c2VkLgogICAqLwogIGh0dHBBZ2VudD86IEFnZW50OwoKICAvKioKICAg
KiBTcGVjaWZ5IGEgY3VzdG9tIGBmZXRjaGAgZnVuY3Rpb24gaW1wbGVtZW50
YXRpb24uCiAgICoKICAgKiBJZiBub3QgcHJvdmlkZWQsIHdlIHVzZSBgbm9k
ZS1mZXRjaGAgb24gTm9kZS5qcyBhbmQgb3RoZXJ3aXNlIGV4cGVjdCB0aGF0
IGBmZXRjaGAgaXMKICAgKiBkZWZpbmVkIGdsb2JhbGx5LgogICAqLwogIGZl
dGNoPzogQ29yZS5GZXRjaCB8IHVuZGVmaW5lZDsKCiAgLyoqCiAgICogVGhl
IG1heGltdW0gbnVtYmVyIG9mIHRpbWVzIHRoYXQgdGhlIGNsaWVudCB3aWxs
IHJldHJ5IGEgcmVxdWVzdCBpbiBjYXNlIG9mIGEKICAgKiB0ZW1wb3Jhcnkg
ZmFpbHVyZSwgbGlrZSBhIG5ldHdvcmsgZXJyb3Igb3IgYSA1WFggZXJyb3Ig
ZnJvbSB0aGUgc2VydmVyLgogICAqCiAgICogQGRlZmF1bHQgMgogICAqLwog
IG1heFJldHJpZXM/OiBudW1iZXI7CgogIC8qKgogICAqIERlZmF1bHQgaGVh
ZGVycyB0byBpbmNsdWRlIHdpdGggZXZlcnkgcmVxdWVzdCB0byB0aGUgQVBJ
LgogICAqCiAgICogVGhlc2UgY2FuIGJlIHJlbW92ZWQgaW4gaW5kaXZpZHVh
bCByZXF1ZXN0cyBieSBleHBsaWNpdGx5IHNldHRpbmcgdGhlCiAgICogaGVh
ZGVyIHRvIGB1bmRlZmluZWRgIG9yIGBudWxsYCBpbiByZXF1ZXN0IG9wdGlv
bnMuCiAgICovCiAgZGVmYXVsdEhlYWRlcnM/OiBDb3JlLkhlYWRlcnM7Cgog
IC8qKgogICAqIERlZmF1bHQgcXVlcnkgcGFyYW1ldGVycyB0byBpbmNsdWRl
IHdpdGggZXZlcnkgcmVxdWVzdCB0byB0aGUgQVBJLgogICAqCiAgICogVGhl
c2UgY2FuIGJlIHJlbW92ZWQgaW4gaW5kaXZpZHVhbCByZXF1ZXN0cyBieSBl
eHBsaWNpdGx5IHNldHRpbmcgdGhlCiAgICogcGFyYW0gdG8gYHVuZGVmaW5l
ZGAgaW4gcmVxdWVzdCBvcHRpb25zLgogICAqLwogIGRlZmF1bHRRdWVyeT86
IENvcmUuRGVmYXVsdFF1ZXJ5Owp9CgovKiogQVBJIENsaWVudCBmb3IgaW50
ZXJmYWNpbmcgd2l0aCB0aGUgTWVvcnBoaXMgVGVzdCA0IEFQSS4gKi8KZXhw
b3J0IGNsYXNzIE1lb3JwaGlzVGVzdDQgZXh0ZW5kcyBDb3JlLkFQSUNsaWVu
dCB7CiAgYXBpS2V5OiBzdHJpbmc7CgogIHByaXZhdGUgX29wdGlvbnM6IENs
aWVudE9wdGlvbnM7CgogIC8qKgogICAqIEFQSSBDbGllbnQgZm9yIGludGVy
ZmFjaW5nIHdpdGggdGhlIE1lb3JwaGlzIFRlc3QgNCBBUEkuCiAgICoKICAg
KiBAcGFyYW0ge3N0cmluZyB8IHVuZGVmaW5lZH0gW29wdHMuYXBpS2V5PXBy
b2Nlc3MuZW52WydNRU9SUEhJU19URVNUXzRfQVBJX0tFWSddID8/IHVuZGVm
aW5lZF0KICAgKiBAcGFyYW0ge0Vudmlyb25tZW50fSBbb3B0cy5lbnZpcm9u
bWVudD1wcm9kdWN0aW9uXSAtIFNwZWNpZmllcyB0aGUgZW52aXJvbm1lbnQg
VVJMIHRvIHVzZSBmb3IgdGhlIEFQSS4KICAgKiBAcGFyYW0ge3N0cmluZ30g
W29wdHMuYmFzZVVSTD1wcm9jZXNzLmVudlsnTUVPUlBISVNfVEVTVF80X0JB
U0VfVVJMJ10gPz8gaHR0cHM6Ly9hcGkuYWNtZS5jb20vdjFdIC0gT3ZlcnJp
ZGUgdGhlIGRlZmF1bHQgYmFzZSBVUkwgZm9yIHRoZSBBUEkuCiAgICogQHBh
cmFtIHtudW1iZXJ9IFtvcHRzLnRpbWVvdXQ9MSBtaW51dGVdIC0gVGhlIG1h
eGltdW0gYW1vdW50IG9mIHRpbWUgKGluIG1pbGxpc2Vjb25kcykgdGhlIGNs
aWVudCB3aWxsIHdhaXQgZm9yIGEgcmVzcG9uc2UgYmVmb3JlIHRpbWluZyBv
dXQuCiAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRzLmh0dHBBZ2VudF0gLSBB
biBIVFRQIGFnZW50IHVzZWQgdG8gbWFuYWdlIEhUVFAocykgY29ubmVjdGlv
bnMuCiAgICogQHBhcmFtIHtDb3JlLkZldGNofSBbb3B0cy5mZXRjaF0gLSBT
cGVjaWZ5IGEgY3VzdG9tIGBmZXRjaGAgZnVuY3Rpb24gaW1wbGVtZW50YXRp
b24uCiAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRzLm1heFJldHJpZXM9Ml0g
LSBUaGUgbWF4aW11bSBudW1iZXIgb2YgdGltZXMgdGhlIGNsaWVudCB3aWxs
IHJldHJ5IGEgcmVxdWVzdC4KICAgKiBAcGFyYW0ge0NvcmUuSGVhZGVyc30g
b3B0cy5kZWZhdWx0SGVhZGVycyAtIERlZmF1bHQgaGVhZGVycyB0byBpbmNs
dWRlIHdpdGggZXZlcnkgcmVxdWVzdCB0byB0aGUgQVBJLgogICAqIEBwYXJh
bSB7Q29yZS5EZWZhdWx0UXVlcnl9IG9wdHMuZGVmYXVsdFF1ZXJ5IC0gRGVm
YXVsdCBxdWVyeSBwYXJhbWV0ZXJzIHRvIGluY2x1ZGUgd2l0aCBldmVyeSBy
ZXF1ZXN0IHRvIHRoZSBBUEkuCiAgICovCiAgY29uc3RydWN0b3IoewogICAg
YmFzZVVSTCA9IENvcmUucmVhZEVudignTUVPUlBISVNfVEVTVF80X0JBU0Vf
VVJMJyksCiAgICBhcGlLZXkgPSBDb3JlLnJlYWRFbnYoJ01FT1JQSElTX1RF
U1RfNF9BUElfS0VZJyksCiAgICAuLi5vcHRzCiAgfTogQ2xpZW50T3B0aW9u
cyA9IHt9KSB7CiAgICBpZiAoYXBpS2V5ID09PSB1bmRlZmluZWQpIHsKICAg
ICAgdGhyb3cgbmV3IEVycm9ycy5NZW9ycGhpc1Rlc3Q0RXJyb3IoCiAgICAg
ICAgIlRoZSBNRU9SUEhJU19URVNUXzRfQVBJX0tFWSBlbnZpcm9ubWVudCB2
YXJpYWJsZSBpcyBtaXNzaW5nIG9yIGVtcHR5OyBlaXRoZXIgcHJvdmlkZSBp
dCwgb3IgaW5zdGFudGlhdGUgdGhlIE1lb3JwaGlzVGVzdDQgY2xpZW50IHdp
dGggYW4gYXBpS2V5IG9wdGlvbiwgbGlrZSBuZXcgTWVvcnBoaXNUZXN0NCh7
IGFwaUtleTogJ015IEFQSSBLZXknIH0pLiIsCiAgICAgICk7CiAgICB9Cgog
ICAgY29uc3Qgb3B0aW9uczogQ2xpZW50T3B0aW9ucyA9IHsKICAgICAgYXBp
S2V5LAogICAgICAuLi5vcHRzLAogICAgICBiYXNlVVJMLAogICAgICBlbnZp
cm9ubWVudDogb3B0cy5lbnZpcm9ubWVudCA/PyAncHJvZHVjdGlvbicsCiAg
ICB9OwoKICAgIGlmIChiYXNlVVJMICYmIG9wdHMuZW52aXJvbm1lbnQpIHsK
ICAgICAgdGhyb3cgbmV3IEVycm9ycy5NZW9ycGhpc1Rlc3Q0RXJyb3IoCiAg
ICAgICAgJ0FtYmlndW91cyBVUkw7IFRoZSBgYmFzZVVSTGAgb3B0aW9uIChv
ciBNRU9SUEhJU19URVNUXzRfQkFTRV9VUkwgZW52IHZhcikgYW5kIHRoZSBg
ZW52aXJvbm1lbnRgIG9wdGlvbiBhcmUgZ2l2ZW4uIElmIHlvdSB3YW50IHRv
IHVzZSB0aGUgZW52aXJvbm1lbnQgeW91IG11c3QgcGFzcyBiYXNlVVJMOiBu
dWxsJywKICAgICAgKTsKICAgIH0KCiAgICBzdXBlcih7CiAgICAgIGJhc2VV
Ukw6IG9wdGlvbnMuYmFzZVVSTCB8fCBlbnZpcm9ubWVudHNbb3B0aW9ucy5l
bnZpcm9ubWVudCB8fCAncHJvZHVjdGlvbiddLAogICAgICB0aW1lb3V0OiBv
cHRpb25zLnRpbWVvdXQgPz8gNjAwMDAgLyogMSBtaW51dGUgKi8sCiAgICAg
IGh0dHBBZ2VudDogb3B0aW9ucy5odHRwQWdlbnQsCiAgICAgIG1heFJldHJp
ZXM6IG9wdGlvbnMubWF4UmV0cmllcywKICAgICAgZmV0Y2g6IG9wdGlvbnMu
ZmV0Y2gsCiAgICB9KTsKICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zOwoK
ICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5OwogIH0KCiAgYWNjb3VudHM6IEFQ
SS5BY2NvdW50cyA9IG5ldyBBUEkuQWNjb3VudHModGhpcyk7CiAgY2FyZHM6
IEFQSS5DYXJkcyA9IG5ldyBBUEkuQ2FyZHModGhpcyk7CiAgc3RhdHVzOiBB
UEkuU3RhdHVzID0gbmV3IEFQSS5TdGF0dXModGhpcyk7CgogIHByb3RlY3Rl
ZCBvdmVycmlkZSBkZWZhdWx0UXVlcnkoKTogQ29yZS5EZWZhdWx0UXVlcnkg
fCB1bmRlZmluZWQgewogICAgcmV0dXJuIHRoaXMuX29wdGlvbnMuZGVmYXVs
dFF1ZXJ5OwogIH0KCiAgcHJvdGVjdGVkIG92ZXJyaWRlIGRlZmF1bHRIZWFk
ZXJzKG9wdHM6IENvcmUuRmluYWxSZXF1ZXN0T3B0aW9ucyk6IENvcmUuSGVh
ZGVycyB7CiAgICByZXR1cm4gewogICAgICAuLi5zdXBlci5kZWZhdWx0SGVh
ZGVycyhvcHRzKSwKICAgICAgLi4udGhpcy5fb3B0aW9ucy5kZWZhdWx0SGVh
ZGVycywKICAgIH07CiAgfQoKICBwcm90ZWN0ZWQgb3ZlcnJpZGUgYXV0aEhl
YWRlcnMob3B0czogQ29yZS5GaW5hbFJlcXVlc3RPcHRpb25zKTogQ29yZS5I
ZWFkZXJzIHsKICAgIHJldHVybiB7IEF1dGhvcml6YXRpb246IHRoaXMuYXBp
S2V5IH07CiAgfQoKICBzdGF0aWMgTWVvcnBoaXNUZXN0NCA9IHRoaXM7Cgog
IHN0YXRpYyBNZW9ycGhpc1Rlc3Q0RXJyb3IgPSBFcnJvcnMuTWVvcnBoaXNU
ZXN0NEVycm9yOwogIHN0YXRpYyBBUElFcnJvciA9IEVycm9ycy5BUElFcnJv
cjsKICBzdGF0aWMgQVBJQ29ubmVjdGlvbkVycm9yID0gRXJyb3JzLkFQSUNv
bm5lY3Rpb25FcnJvcjsKICBzdGF0aWMgQVBJQ29ubmVjdGlvblRpbWVvdXRF
cnJvciA9IEVycm9ycy5BUElDb25uZWN0aW9uVGltZW91dEVycm9yOwogIHN0
YXRpYyBBUElVc2VyQWJvcnRFcnJvciA9IEVycm9ycy5BUElVc2VyQWJvcnRF
cnJvcjsKICBzdGF0aWMgTm90Rm91bmRFcnJvciA9IEVycm9ycy5Ob3RGb3Vu
ZEVycm9yOwogIHN0YXRpYyBDb25mbGljdEVycm9yID0gRXJyb3JzLkNvbmZs
aWN0RXJyb3I7CiAgc3RhdGljIFJhdGVMaW1pdEVycm9yID0gRXJyb3JzLlJh
dGVMaW1pdEVycm9yOwogIHN0YXRpYyBCYWRSZXF1ZXN0RXJyb3IgPSBFcnJv
cnMuQmFkUmVxdWVzdEVycm9yOwogIHN0YXRpYyBBdXRoZW50aWNhdGlvbkVy
cm9yID0gRXJyb3JzLkF1dGhlbnRpY2F0aW9uRXJyb3I7CiAgc3RhdGljIElu
dGVybmFsU2VydmVyRXJyb3IgPSBFcnJvcnMuSW50ZXJuYWxTZXJ2ZXJFcnJv
cjsKICBzdGF0aWMgUGVybWlzc2lvbkRlbmllZEVycm9yID0gRXJyb3JzLlBl
cm1pc3Npb25EZW5pZWRFcnJvcjsKICBzdGF0aWMgVW5wcm9jZXNzYWJsZUVu
dGl0eUVycm9yID0gRXJyb3JzLlVucHJvY2Vzc2FibGVFbnRpdHlFcnJvcjsK
fQoKZXhwb3J0IGNvbnN0IHsKICBNZW9ycGhpc1Rlc3Q0RXJyb3IsCiAgQVBJ
RXJyb3IsCiAgQVBJQ29ubmVjdGlvbkVycm9yLAogIEFQSUNvbm5lY3Rpb25U
aW1lb3V0RXJyb3IsCiAgQVBJVXNlckFib3J0RXJyb3IsCiAgTm90Rm91bmRF
cnJvciwKICBDb25mbGljdEVycm9yLAogIFJhdGVMaW1pdEVycm9yLAogIEJh
ZFJlcXVlc3RFcnJvciwKICBBdXRoZW50aWNhdGlvbkVycm9yLAogIEludGVy
bmFsU2VydmVyRXJyb3IsCiAgUGVybWlzc2lvbkRlbmllZEVycm9yLAogIFVu
cHJvY2Vzc2FibGVFbnRpdHlFcnJvciwKfSA9IEVycm9yczsKCmV4cG9ydCBp
bXBvcnQgdG9GaWxlID0gVXBsb2Fkcy50b0ZpbGU7CmV4cG9ydCBpbXBvcnQg
ZmlsZUZyb21QYXRoID0gVXBsb2Fkcy5maWxlRnJvbVBhdGg7CgpleHBvcnQg
bmFtZXNwYWNlIE1lb3JwaGlzVGVzdDQgewogIC8vIEhlbHBlciBmdW5jdGlv
bnMKICBleHBvcnQgaW1wb3J0IHRvRmlsZSA9IFVwbG9hZHMudG9GaWxlOwog
IGV4cG9ydCBpbXBvcnQgZmlsZUZyb21QYXRoID0gVXBsb2Fkcy5maWxlRnJv
bVBhdGg7CgogIGV4cG9ydCBpbXBvcnQgUmVxdWVzdE9wdGlvbnMgPSBDb3Jl
LlJlcXVlc3RPcHRpb25zOwoKICBleHBvcnQgaW1wb3J0IEFjY291bnRzID0g
QVBJLkFjY291bnRzOwogIGV4cG9ydCBpbXBvcnQgQWNjb3VudGNvbmZpZ3Vy
YXRpb24gPSBBUEkuQWNjb3VudGNvbmZpZ3VyYXRpb247CiAgZXhwb3J0IGlt
cG9ydCBBY2NvdW50VXBkYXRlUGFyYW1zID0gQVBJLkFjY291bnRVcGRhdGVQ
YXJhbXM7CgogIGV4cG9ydCBpbXBvcnQgQ2FyZHMgPSBBUEkuQ2FyZHM7CiAg
ZXhwb3J0IGltcG9ydCBDYXJkID0gQVBJLkNhcmQ7CiAgZXhwb3J0IGltcG9y
dCBGaW5hbmNpYWx0cmFuc2FjdGlvbiA9IEFQSS5GaW5hbmNpYWx0cmFuc2Fj
dGlvbjsKICBleHBvcnQgaW1wb3J0IENhcmRQcm92aXNpb25SZXNwb25zZSA9
IEFQSS5DYXJkUHJvdmlzaW9uUmVzcG9uc2U7CiAgZXhwb3J0IGltcG9ydCBD
YXJkQ3JlYXRlUGFyYW1zID0gQVBJLkNhcmRDcmVhdGVQYXJhbXM7CiAgZXhw
b3J0IGltcG9ydCBDYXJkVXBkYXRlUGFyYW1zID0gQVBJLkNhcmRVcGRhdGVQ
YXJhbXM7CiAgZXhwb3J0IGltcG9ydCBDYXJkUHJvdmlzaW9uUGFyYW1zID0g
QVBJLkNhcmRQcm92aXNpb25QYXJhbXM7CgogIGV4cG9ydCBpbXBvcnQgU3Rh
dHVzID0gQVBJLlN0YXR1czsKICBleHBvcnQgaW1wb3J0IFN0YXR1c1JldHJp
ZXZlUmVzcG9uc2UgPSBBUEkuU3RhdHVzUmV0cmlldmVSZXNwb25zZTsKfQoK
ZXhwb3J0IGRlZmF1bHQgTWVvcnBoaXNUZXN0NDsK
